<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BYTEWISE S.A.S. – MVP Inventarios</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    :root{
      --primary:#1ABC9C; /* verde azulado */
      --dark:#4D4D4D;    /* gris oscuro */
      --bg:#F7F9FB;      /* fondo suave */
      --white:#fff;
      --muted:#8C8C8C;
      --danger:#E74C3C;
      --warning:#F39C12;
      --ok:#2ECC71;
      --radius:16px;
      --shadow:0 6px 24px rgba(0,0,0,.08);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:"Poppins",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--dark);background:var(--bg)}
    a{color:var(--primary);text-decoration:none}
    .container{max-width:1200px;margin:0 auto;padding:24px}
    .card{background:var(--white);border-radius:var(--radius);box-shadow:var(--shadow);padding:20px}
    .grid{display:grid;gap:18px}
    .grid.cols-2{grid-template-columns:1fr 1fr}
    .grid.cols-3{grid-template-columns:repeat(3,1fr)}
    .grid.cols-4{grid-template-columns:repeat(4,1fr)}
    @media(max-width:980px){.grid.cols-3,.grid.cols-4{grid-template-columns:1fr 1fr}}
    @media(max-width:720px){.grid.cols-2,.grid.cols-3,.grid.cols-4{grid-template-columns:1fr}}

    .brand{display:flex;align-items:center;gap:12px;margin-bottom:24px}
    .logo{width:42px;height:42px;border-radius:12px;background:conic-gradient(from 180deg,var(--primary),#2bd4bd 40%,#7eeadf 70%,var(--primary));display:grid;place-items:center;color:#004d40;font-weight:800}
    h1{font-size:22px;margin:0;color:#223}
    h2{font-size:18px;margin:0 0 8px}
    h3{font-size:16px;margin:0 0 6px}
    p{margin:0 0 12px;color:#333}

    .topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
    .btn{border:0;border-radius:12px;padding:10px 14px;background:var(--primary);color:#fff;font-weight:600;cursor:pointer;box-shadow:var(--shadow)}
    .btn.secondary{background:#2c3e50}
    .btn.light{background:#ECF9F6;color:#0b6b58}
    .btn.warn{background:var(--warning)}
    .btn.danger{background:var(--danger)}
    .btn.ghost{background:transparent;color:var(--primary);box-shadow:none}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .toolbar{display:flex;gap:10px;flex-wrap:wrap}

    .input{width:100%;padding:10px 12px;border:1px solid #E6ECF1;border-radius:10px;background:#fff}
    label{font-size:12px;color:#667;margin-bottom:6px;display:block}
    .field{margin-bottom:12px}

    .kpi{display:flex;align-items:center;gap:12px}
    .kpi .icon{width:44px;height:44px;border-radius:12px;display:grid;place-items:center;background:#ECF9F6;color:#0b6b58;font-weight:800}
    .kpi .val{font-size:22px;font-weight:700}
    .kpi .lbl{font-size:12px;color:#667}

    table{width:100%;border-collapse:collapse}
    th,td{padding:10px 8px;text-align:left;border-bottom:1px solid #EFF3F6}
    th{font-size:12px;color:#667;font-weight:600}
    tr:hover td{background:#FAFEFD}

    .pill{display:inline-block;padding:4px 8px;border-radius:999px;font-size:12px}
    .pill.out{background:#FFF1F0;color:#B83227}
    .pill.in{background:#F4FFF7;color:#1B7A4A}

    /* auth screen */
    #auth{min-height:100vh;display:grid;place-items:center}
    .auth-card{max-width:440px;width:100%}
    .muted{color:var(--muted);font-size:12px}
    .switch{text-align:center;margin-top:8px}

    /* sections */
    .hidden{display:none !important}
    .section{margin-bottom:18px}

    .footer{margin-top:18px;text-align:center;color:#9aa; font-size:12px}
      .chart-box{height:260px}
    body{overflow-x:hidden}
    .card{overflow:hidden}
  </style>
</head>
<body>
  <div id="auth" class="container">
    <div class="auth-card card">
      <div class="brand">
        <div class="logo">BW</div>
        <div>
          <h1>BYTEWISE S.A.S.</h1>
          <span class="muted">MVP – Gestión de Inventarios (SaaS)</span>
        </div>
      </div>
      <div id="auth-forms">
        <div id="login-form">
          <h2>Iniciar sesión</h2>
          <div class="field">
            <label>Correo</label>
            <input id="loginEmail" class="input" type="email" placeholder="empresa@bytewise.co" />
          </div>
          <div class="field">
            <label>Contraseña</label>
            <input id="loginPass" class="input" type="password" placeholder="••••••••" />
          </div>
          <div class="toolbar">
            <button class="btn" id="btnLogin">Entrar</button>
            <button class="btn light" id="seedBtn" title="Carga datos de demostración">Cargar demo</button>
          </div>
          <div class="switch">
            <span class="muted">¿No tienes cuenta?</span> <a href="#" id="toRegister">Crear cuenta</a>
          </div>
        </div>
        <div id="register-form" class="hidden">
          <h2>Crear cuenta</h2>
          <div class="field">
            <label>Nombre de empresa</label>
            <input id="regName" class="input" type="text" placeholder="Mi PYME S.A.S." />
          </div>
          <div class="field">
            <label>Correo</label>
            <input id="regEmail" class="input" type="email" placeholder="admin@mipyme.com" />
          </div>
          <div class="field">
            <label>Contraseña</label>
            <input id="regPass" class="input" type="password" placeholder="Crea una contraseña" />
          </div>
          <div class="toolbar">
            <button class="btn" id="btnRegister">Registrar</button>
            <button class="btn ghost" id="toLogin">Volver a iniciar sesión</button>
          </div>
        </div>
      </div>
    </div>
    <div class="footer">© <span id="year"></span> Bytewise S.A.S. – MVP educativo</div>
  </div>

  <div id="app" class="container hidden">
    <div class="topbar">
      <div class="brand">
        <div class="logo">BW</div>
        <div>
          <h1>Panel – Inventarios</h1>
          <span class="muted" id="companyName"></span>
        </div>
      </div>
      <div class="toolbar">
        <button class="btn light" id="btnExportCSV" title="Exportar inventario a CSV">Exportar CSV</button>
        <button class="btn secondary" id="btnLogout">Cerrar sesión</button>
      </div>
    </div>

    <div class="grid cols-3">
      <div class="card kpi">
        <div class="icon">Σ</div>
        <div>
          <div class="val" id="kpiItems">0</div>
          <div class="lbl">Unidades en inventario</div>
        </div>
      </div>
      <div class="card kpi">
        <div class="icon">$</div>
        <div>
          <div class="val" id="kpiValue">$0</div>
          <div class="lbl">Valor total del inventario</div>
        </div>
      </div>
      <div class="card kpi">
        <div class="icon">#</div>
        <div>
          <div class="val" id="kpiProducts">0</div>
          <div class="lbl">Productos registrados</div>
        </div>
      </div>
    </div>

    <div class="grid cols-2" style="margin-top:18px">
      <div class="card">
        <h2>Productos</h2>
        <div class="grid cols-4">
          <div class="field"><label>Nombre</label><input id="pName" class="input" placeholder="Ej. Cuaderno A5" /></div>
          <div class="field"><label>Categoría</label><input id="pCat" class="input" placeholder="Papelería" /></div>
          <div class="field"><label>Precio (COP)</label><input id="pPrice" class="input" type="number" min="0" step="100" placeholder="5000" /></div>
          <div class="field"><label>Cantidad</label><input id="pQty" class="input" type="number" min="0" step="1" placeholder="10" /></div>
        </div>
        <div class="toolbar" style="margin-bottom:8px">
          <button class="btn" id="btnAddProduct">Agregar / Actualizar</button>
          <button class="btn ghost" id="btnClearForm">Limpiar</button>
        </div>
        <div class="field"><input id="search" class="input" placeholder="Buscar por nombre o categoría..."/></div>
        <div class="table-wrap">
          <table id="tblProducts">
            <thead>
              <tr>
                <th>Nombre</th><th>Categoría</th><th>Precio</th><th>Cantidad</th><th>Total</th><th></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <div class="card">
        <h2>Movimientos</h2>
        <div class="grid cols-4">
          <div class="field">
            <label>Producto</label>
            <select id="mProduct" class="input"></select>
          </div>
          <div class="field">
            <label>Tipo</label>
            <select id="mType" class="input">
              <option value="out">Salida (venta)</option>
              <option value="in">Entrada (compra)</option>
            </select>
          </div>
          <div class="field">
            <label>Cantidad</label>
            <input id="mQty" class="input" type="number" min="1" step="1" value="1"/>
          </div>
          <div class="field">
            <label>Nota</label>
            <input id="mNote" class="input" placeholder="Observaciones" />
          </div>
        </div>
        <div class="toolbar">
          <button class="btn" id="btnAddMove">Registrar movimiento</button>
          <button class="btn warn" id="btnUndoLast">Deshacer último</button>
        </div>

        <div style="margin-top:14px">
          <table id="tblMoves">
            <thead>
              <tr>
                <th>Fecha</th><th>Producto</th><th>Tipo</th><th>Cant.</th><th>Nota</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="grid cols-2" style="margin-top:18px">
      <div class="card">
        <h2>Actividad (últimos 6 meses)</h2>
        <div class="chart-box"><canvas id="movChart"></canvas></div>
      </div>
      <div class="card">
        <h2>Perfil</h2>
        <div class="grid cols-2">
          <div class="field"><label>Empresa</label><input id="cName" class="input" /></div>
          <div class="field"><label>Plan</label>
            <select id="cPlan" class="input">
              <option>Básico</option>
              <option>Estándar</option>
              <option>Premium</option>
            </select>
          </div>
        </div>
        <div class="toolbar">
          <button class="btn" id="btnSaveCompany">Guardar</button>
          <button class="btn ghost" id="btnDeleteAccount">Eliminar cuenta (demo)</button>
        </div>
        <p class="muted">Este MVP usa almacenamiento local del navegador. No requiere servidor.</p>
      </div>
    </div>

    <div class="footer">Hecho con ♥ para demostración de Bytewise – LocalStorage + JS puro</div>
  </div>

<script>
(function(){
  const $ = sel => document.querySelector(sel);
  const $$ = sel => Array.from(document.querySelectorAll(sel));
  const LS = {
    get(key, def){ try{ return JSON.parse(localStorage.getItem(key)) ?? def }catch{ return def } },
    set(key, val){ localStorage.setItem(key, JSON.stringify(val)) },
    del(key){ localStorage.removeItem(key) }
  };
  const YEAR_EL = $('#year'); YEAR_EL.textContent = new Date().getFullYear();

  // ---------------- AUTH -----------------
  const authView = $('#auth');
  const appView = $('#app');
  const loginForm = $('#login-form');
  const regForm = $('#register-form');
  $('#toRegister').onclick = () => { loginForm.classList.add('hidden'); regForm.classList.remove('hidden'); };
  $('#toLogin').onclick = () => { regForm.classList.add('hidden'); loginForm.classList.remove('hidden'); };

  const USERS_KEY = 'bw_users';
  const CURRENT_KEY = 'bw_current_user';
  const DATA_PREFIX = 'bw_data_'; // per-user data key

  function getUsers(){ return LS.get(USERS_KEY, []) }
  function saveUsers(list){ LS.set(USERS_KEY, list) }

  function register(name,email,pass){
    email = (email||'').trim().toLowerCase();
    if(!name || !email || !pass) return {ok:false,msg:'Completa todos los campos'};
    const users = getUsers();
    if(users.find(u=>u.email===email)) return {ok:false,msg:'El correo ya está registrado'};
    users.push({name,email,pass,plan:'Básico'});
    saveUsers(users);
    // init user dataset
    LS.set(DATA_PREFIX+email, {company:{name,plan:'Básico'}, products:[], moves:[]});
    return {ok:true}
  }

  function login(email,pass){
    email = (email||'').trim().toLowerCase();
    const u = getUsers().find(u=>u.email===email && u.pass===pass);
    if(!u) return {ok:false,msg:'Credenciales inválidas'};
    LS.set(CURRENT_KEY, {email});
    return {ok:true}
  }

  function logout(){ LS.del(CURRENT_KEY); }
  function current(){ return LS.get(CURRENT_KEY,null) }

  // Seed demo account
  $('#seedBtn').onclick = () => {
    const demoEmail = 'demo@bytewise.co';
    const exists = getUsers().some(u=>u.email===demoEmail);
    if(!exists){
      register('Demo Bytewise', demoEmail, 'demo123');
      const data = LS.get(DATA_PREFIX+demoEmail);
      data.products = [
        {id:id(), name:'Cuaderno A5', cat:'Papelería', price:5000, qty:40},
        {id:id(), name:'Tóner HP 12A', cat:'Impresión', price:220000, qty:5},
        {id:id(), name:'Memoria USB 32GB', cat:'Accesorios', price:35000, qty:18}
      ];
      const now = new Date();
      data.moves = [
        {id:id(), date:addMonths(now,-1), type:'out', productId:data.products[0].id, qty:5, note:'Venta colegio'},
        {id:id(), date:addMonths(now,-2), type:'in',  productId:data.products[1].id, qty:3, note:'Compra proveedor'},
        {id:id(), date:addMonths(now,-3), type:'out', productId:data.products[2].id, qty:7, note:'Venta feria'}
      ];
      LS.set(DATA_PREFIX+demoEmail, data);
    }
    $('#loginEmail').value = demoEmail; $('#loginPass').value = 'demo123';
  };

  $('#btnRegister').onclick = () => {
    const r = register($('#regName').value, $('#regEmail').value, $('#regPass').value);
    if(!r.ok) return alert(r.msg);
    alert('Cuenta creada. Ahora inicia sesión.');
    $('#toLogin').click();
  };

  $('#btnLogin').onclick = () => {
    const r = login($('#loginEmail').value, $('#loginPass').value);
    if(!r.ok) return alert(r.msg);
    showApp();
  };

  // Auto-login if already authenticated
  if(current()){ showApp(true) }

  // ---------------- APP STATE -----------------
  let userEmail = null; // current user email
  let db = null;        // {company, products[], moves[]}

  function loadDB(){ db = LS.get(DATA_PREFIX+userEmail,{company:{name:'',plan:'Básico'},products:[],moves:[]}) }
  function saveDB(){ LS.set(DATA_PREFIX+userEmail, db) }

  // ---------------- UI BINDINGS -----------------
  const kpiItems = $('#kpiItems');
  const kpiValue = $('#kpiValue');
  const kpiProducts = $('#kpiProducts');
  const companyName = $('#companyName');

  const pName = $('#pName');
  const pCat = $('#pCat');
  const pPrice = $('#pPrice');
  const pQty = $('#pQty');
  const search = $('#search');
  const tblProducts = $('#tblProducts tbody');

  const mProduct = $('#mProduct');
  const mType = $('#mType');
  const mQty = $('#mQty');
  const mNote = $('#mNote');
  const tblMoves = $('#tblMoves tbody');

  const cName = $('#cName');
  const cPlan = $('#cPlan');

  let editingId = null; // product id when editing
  let movChart = null;

  function showApp(skipReload){
    const c = current();
    if(!c) return;
    userEmail = c.email;
    loadDB();
    authView.classList.add('hidden');
    appView.classList.remove('hidden');
    renderCompany();
    renderProducts();
    renderMoves();
    renderKPIs();
    renderProductsOptions();
    renderChart();
  }

  function renderCompany(){
    companyName.textContent = `${db.company.name || '(Sin nombre)'} — Plan ${db.company.plan || 'Básico'}`;
    cName.value = db.company.name || '';
    cPlan.value = db.company.plan || 'Básico';
  }

  function renderProducts(){
    const term = (search.value||'').toLowerCase();
    const rows = db.products
      .filter(p => p.name.toLowerCase().includes(term) || p.cat.toLowerCase().includes(term))
      .map(p => {
        const total = p.price * p.qty;
        return `<tr>
          <td>${escapeHtml(p.name)}</td>
          <td>${escapeHtml(p.cat)}</td>
          <td>$${fmt(p.price)}</td>
          <td>${p.qty}</td>
          <td>$${fmt(total)}</td>
          <td>
            <button class="btn light" data-edit="${p.id}">Editar</button>
            <button class="btn danger" data-del="${p.id}">Eliminar</button>
          </td>
        </tr>`
      }).join('');
    tblProducts.innerHTML = rows || `<tr><td colspan="6">Sin productos</td></tr>`;

    // Bind row buttons
    $$("[data-edit]").forEach(b=> b.onclick = () => startEdit(b.dataset.edit));
    $$("[data-del]").forEach(b=> b.onclick = () => delProduct(b.dataset.del));
  }

  function renderProductsOptions(){
    mProduct.innerHTML = db.products.map(p=>`<option value="${p.id}">${escapeHtml(p.name)}</option>`).join('');
  }

  function renderMoves(){
    const rows = db.moves.slice().sort((a,b)=> new Date(b.date)-new Date(a.date)).map(m=>{
      const p = db.products.find(x=>x.id===m.productId);
      return `<tr>
        <td>${fmtDate(m.date)}</td>
        <td>${escapeHtml(p? p.name : '—')}</td>
        <td>${m.type==='out'?'<span class="pill out">Salida</span>':'<span class="pill in">Entrada</span>'}</td>
        <td>${m.qty}</td>
        <td>${escapeHtml(m.note||'')}</td>
      </tr>`
    }).join('');
    tblMoves.innerHTML = rows || `<tr><td colspan="5">Sin movimientos</td></tr>`;
  }

  function renderKPIs(){
    const totalItems = db.products.reduce((s,p)=>s+(+p.qty||0),0);
    const invValue = db.products.reduce((s,p)=>s+((+p.qty||0)*(+p.price||0)),0);
    kpiItems.textContent = fmt(totalItems);
    kpiValue.textContent = `$${fmt(invValue)}`;
    kpiProducts.textContent = fmt(db.products.length);
  }

  function renderChart(){
    const {labels, inData, outData} = lastMonthsMovs(6);
    const ctx = document.getElementById('movChart');
    if(movChart){ movChart.destroy(); }
    movChart = new Chart(ctx, {
      type:'line',
      data:{
        labels,
        datasets:[
          {label:'Entradas', data:inData},
          {label:'Salidas', data:outData}
        ]
      },
      options:{ responsive:true, maintainAspectRatio:false }
    });
  }

  // ---------- Product CRUD ----------
  $('#btnAddProduct').onclick = () => {
    const name = (pName.value||'').trim();
    const cat  = (pCat.value||'').trim();
    const price = +pPrice.value; const qty = +pQty.value;
    if(!name || !cat || isNaN(price) || isNaN(qty)) return alert('Completa todos los campos del producto.');

    if(editingId){
      const p = db.products.find(x=>x.id===editingId);
      if(!p) return;
      p.name = name; p.cat = cat; p.price = price; p.qty = qty;
      editingId = null;
    } else {
      db.products.push({id:id(), name, cat, price, qty});
    }
    saveDB();
    clearForm();
    renderProducts();
    renderProductsOptions();
    renderKPIs();
  };
  $('#btnClearForm').onclick = clearForm;
  search.oninput = renderProducts;

  function startEdit(pid){
    const p = db.products.find(x=>x.id===pid); if(!p) return;
    editingId = pid;
    pName.value = p.name; pCat.value = p.cat; pPrice.value = p.price; pQty.value = p.qty;
    pName.focus();
  }
  function delProduct(pid){
    if(!confirm('¿Eliminar producto?')) return;
    db.products = db.products.filter(p=>p.id!==pid);
    // también limpiar movimientos asociados
    db.moves = db.moves.filter(m=>m.productId!==pid);
    saveDB();
    renderProducts(); renderProductsOptions(); renderMoves(); renderKPIs(); renderChart();
  }
  function clearForm(){ editingId=null; pName.value=''; pCat.value=''; pPrice.value=''; pQty.value=''; }

  // ---------- Movements ----------
  $('#btnAddMove').onclick = () => {
    const pid = mProduct.value; if(!pid) return alert('Registra productos primero.');
    const qty = +mQty.value; if(isNaN(qty)||qty<=0) return alert('Cantidad inválida');
    const type = mType.value; const note = mNote.value;
    const p = db.products.find(x=>x.id===pid); if(!p) return;

    if(type==='out' && p.qty<qty) return alert('Inventario insuficiente para salida.');

    // apply
    p.qty += (type==='in'? qty : -qty);
    db.moves.push({id:id(), date:new Date().toISOString(), type, productId:pid, qty, note});
    saveDB();
    mQty.value = 1; mNote.value='';
    renderProducts(); renderMoves(); renderKPIs(); renderChart();
  };

  $('#btnUndoLast').onclick = () => {
    if(!db.moves.length) return alert('No hay movimientos.');
    const last = db.moves.pop();
    const p = db.products.find(x=>x.id===last.productId);
    if(p){ p.qty += (last.type==='out'? last.qty : -last.qty); }
    saveDB();
    renderProducts(); renderMoves(); renderKPIs(); renderChart();
  };

  // ---------- Company/profile ----------
  $('#btnSaveCompany').onclick = () => {
    db.company.name = cName.value.trim();
    db.company.plan = cPlan.value;
    saveDB();
    renderCompany();
  };

  $('#btnDeleteAccount').onclick = () => {
    if(!confirm('Esto eliminará TODOS los datos locales de esta cuenta (solo demo). ¿Continuar?')) return;
    LS.del(DATA_PREFIX+userEmail);
    logout();
    location.reload();
  };

  // ---------- Export CSV ----------
  $('#btnExportCSV').onclick = () => {
    if(!db.products.length){ alert('Sin productos'); return; }
    const header = ['Nombre','Categoría','Precio','Cantidad','Total'];
    const rows = db.products.map(p=>[p.name,p.cat,p.price,p.qty,(p.price*p.qty)]);
    const csv = [header].concat(rows).map(r=>r.map(csvCell).join(',')).join('\n');
    const blob = new Blob(["\uFEFF"+csv],{type:'text/csv;charset=utf-8;'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = `inventario_${(db.company.name||'empresa').replace(/\s+/g,'_')}.csv`;
    document.body.appendChild(a); a.click(); a.remove();
  };

  // ---------- Logout ----------
  $('#btnLogout').onclick = () => { logout(); location.reload(); };

  // ---------- Helpers ----------
  function id(){ return Math.random().toString(36).slice(2,10) }
  function fmt(n){ return Number(n).toLocaleString('es-CO') }
  function fmtDate(d){ const dt = new Date(d); return dt.toLocaleDateString('es-CO',{year:'2-digit',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'}) }
  function csvCell(v){
    if(v==null) return '';
    const s = String(v).replaceAll('"','""');
    return /[",\n]/.test(s) ? `"${s}"` : s;
  }
  function escapeHtml(s){ return String(s).replace(/[&<>"']/g, m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[m])) }
  function addMonths(date, m){ const d = new Date(date); d.setMonth(d.getMonth()+m); return d.toISOString() }

  function lastMonthsMovs(n){
    const labels=[]; const inData=[]; const outData=[];
    const now=new Date();
    for(let i=n-1;i>=0;i--){
      const d=new Date(now.getFullYear(), now.getMonth()-i, 1);
      const label = d.toLocaleDateString('es-CO',{month:'short'});
      labels.push(label);
      const mFirst = new Date(d.getFullYear(), d.getMonth(), 1);
      const mLast  = new Date(d.getFullYear(), d.getMonth()+1, 0);
      const ms = db.moves.filter(x=>{
        const xd=new Date(x.date); return xd>=mFirst && xd<=mLast;
      });
      inData.push(ms.filter(x=>x.type==='in').length);
      outData.push(ms.filter(x=>x.type==='out').length);
    }
    return {labels,inData,outData};
  }
})();
</script>
</body>
</html>
